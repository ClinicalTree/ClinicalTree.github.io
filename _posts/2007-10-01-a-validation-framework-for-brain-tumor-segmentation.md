---
title: A Validation Framework for Brain Tumor Segmentation
author: [CL_AT_NeculaiArchipPhD,CL_AT_FerencAJoleszMD,CL_AT_SimonKWarfieldPhD]
date: 2007-10-01 00:00:00 +0700 +07
categories: [Academic Radiology, Volume 14, Issue 10]
tags: [Journals,General Radiology]
---
## Rationale and Objectives

We introduce a validation framework for the segmentation of brain tumors from magnetic resonance (MR) images. A novel unsupervised semiautomatic brain tumor segmentation algorithm is also presented.

## Materials and Methods

The proposed framework consists of 1) T1-weighted MR images of patients with brain tumors, 2) segmentation of brain tumors performed by four independent experts, 3) segmentation of brain tumors generated by a semiautomatic algorithm, and 4) a software tool that estimates the performance of segmentation algorithms.

## Results

We demonstrate the validation of the novel segmentation algorithm within the proposed framework. We show its performance and compare it with existent segmentation. The image datasets and software are available at  http://www.brain-tumor-repository.org/ .

## Conclusions

We present an Internet resource that provides access to MR brain tumor image data and segmentation that can be openly used by the research community. Its purpose is to encourage the development and evaluation of segmentation methods by providing raw test and image data, human expert segmentation results, and methods for comparing segmentation results.

Brain tumor segmentation has long been recognized as a difficult problem. Many interactive and automated algorithms have been proposed for it for various types of clinical applications. It includes neurosurgery planning, radio- and chemotherapy monitoring and drug discovery. Some representative work can be found in ( ).

Despite the variety of methods published, there is no general algorithm accepted to segment brain tumors from magnetic resonance (MR) images. The reasons are manifold: 1) it is difficult to validate the segmentation algorithms due to intra- and interoperator variability in outlining the tumors; 2) the ground truth is often difficult to define; 3) the segmentation methods are tested on different image datasets; and 4) no common brain tumors database is available that enables standard benchmarking and comparison between various types of segmentation techniques; 5) no consensus exists on metrics to use for validation of segmentation algorithms; and 6) large datasets of MR brain tumor images are often not available for researchers that design segmentation algorithms.

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Materials and methods

## Brain Tumor Database

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

Table 1


Details on the Current 10 Magnetic Resonance Imaging Datasets of Brain Tumors Proposed as Part of the Validation Framework


Patient Number Tumor Location 1 Meningioma Left frontal 2 Meningioma Left parasellar 3 Meningioma Right parietal 4 Low-grade glioma Left frontal 5 Astrocytoma Right frontal 6 Low-grade glioma Right frontal 7 Astrocytoma Right frontal 8 Astrocytoma Left temporal 9 Astrocytoma Left frontotemporal 10 Low-grade glioma Left temporal

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Existent Segmentation Data

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

![Figure 1, Example of brain tumor (a) and its segmentation performed by the four experts (b–e) . The variability of the segmentation can be noticed. ( Fig 1 continues ).](https://storage.googleapis.com/dl.dentistrykey.com/clinical/AValidationFrameworkforBrainTumorSegmentation/0_1s20S1076633207004072.jpg)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## The Performance Assessment of Image Segmentation Algorithms

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## A Novel Spectral Clustering Algorithm for Brain Tumor Segmentation

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

![Figure 2, The scheme demonstrating how to validate a novel brain tumor segmentation within the proposed framework. Simultaneous truth and performance level estimation will combine existent segmentation both generated by experts and segmentation algorithm and will assess their performances.](https://storage.googleapis.com/dl.dentistrykey.com/clinical/AValidationFrameworkforBrainTumorSegmentation/1_1s20S1076633207004072.jpg)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

NCut(A,B)=cut(A,B)assoc(A,V)+cut(A,B)assoc(B,V).
N

C

u

t

(

A

,

B

)

=

c

u

t

(

A

,

B

)

a

s

s

o

c

(

A

,

V

)

+

c

u

t

(

A

,

B

)

a

s

s

o

c

(

B

,

V

)

.


[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

Sij=⎧⎩⎨⎪⎪1−∥F(i)−F(j)∥2maxF−minF∥X(i)−X(j)∥20if∥X(i)−X(j)∥2<rotherwise⎫⎭⎬⎪⎪
S

i

j

=

{

1

−

∥

F

(

i

)

−

F

(

j

)

∥

2

m

a

x

⁡

F

−

m

i

n

⁡

F

∥

X

(

i

)

−

X

(

j

)

∥

2

i

f

∥

X

(

i

)

−

X

(

j

)

∥

2

<

r

0

o

t

h

e

r

w

i

s

e

}


where _X_ ( _i_ ) is the spatial location of node _i_ , and _F_ ( _i_ ) is a feature vector, based on intensity. The values _maxF_ and _minF_ are, respectively, the maximum and the minimum values of _F_ for the all the pixels in the image. Finally, the similarity matrix _S_ is normalized by _S = S/max_ ( _S_ ) as proposed previously ( ). A requirement of NCut is the number of clusters. Overcoming this problem is a challenging task. Unsupervised clustering based solely on Fiedler eigenvector is a potential solution. In the unsupervised clustering, the user does not need to explicitly specify the number of clusters. More details follow.


[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Fiedler Eigenvector for Unsupervised Image Segmentation

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Results

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

![Figure 3, Results of the novel segmentation algorithm and comparisons with existent segmentation data in the proposed database for the Patient 4. (a) Tumor region. (b) The four experts segmentation, (c) Kaus result, (d) the novel method (Fiedler based) result, and (e) the ground truth estimated by simultaneous truth and performance level estimation.](https://storage.googleapis.com/dl.dentistrykey.com/clinical/AValidationFrameworkforBrainTumorSegmentation/2_1s20S1076633207004072.jpg)

Table 2


The STAPLE Output on for the 10 Datasets Used


Expert 1 Expert 2 Expert 3 Expert 4 Kaus Novel Method (Fiedler based) Patient 1_pj_ 0.986 1.000 0.959 1.000 1.000 1.000_qj_ 0.998 0.997 0.999 1.000 1.000 1.000 Patient 2_pj_ 0.899 0.920 0.857 0.809 0.822 0.947_qj_ 0.999 0.999 0.999 0.999 0.999 0.999 Patient 3_pj_ 0.945 0.933 0.977 0.936 0.936 0.798_qj_ 0.999 0.999 0.999 1.000 1.000 1.000 Patient 4_pj_ 0.988 0.970 0.875 0.733 0.733 0.733_qj_ 0.988 0.999 0.999 1.000 1.000 0.999 Patient 5_pj_ 0.981 0.910 0.949 0.813 0.793 0.837_qj_ 0.999 0.999 0.999 0.999 0.999 1.000 Patient 6_pj_ 0.899 0.858 0.968 0.907 0.905 0.960_qj_ 0.999 0.999 0.999 0.999 0.999 0.999 Patient 7_pj_ 0.904 0.864 0.929 0.951 0.946 0.947_qj_ 0.999 0.999 0.999 0.999 0.999 0.999 Patient 8_pj_ 0.907 0.938 0.946 0.753 0.736 0.931_qj_ 0.999 0.999 0.999 0.999 0.999 0.999 Patient 9_pj_ 0.955 0.930 0.975 0.922 0.918 0.993_qj_ 0.999 0.999 0.999 0.999 0.999 0.998 Patient 10_pj_ 0.867 0.978 0.971 0.908 0.978 0.956_qj_ 0.999 1.000 0.998 0.999 1.000 0.998 Average_pj_ 0.9331 0.9301 0.9406 0.8732 0.8767 0.9102_qj_ 0.9978 0.9989 0.9989 0.9993 0.9994 0.9991

The segmentation of four experts, Kaus’ method, and a novel algorithm (Fiedler based) are used as input for simultaneous truth and performance level estimation. _pj_ represent the true-positive fraction or sensitivity, while _qj_ represent the true-negative fraction or specificity.


![Figure 4, The performance of the new segmentation method (Fiedler-based), and comparison with existent segmentation data. (a) Sensitivity or true-positive fraction ( p j ), and (b) specificity or false-positive fraction ( q j ).](https://storage.googleapis.com/dl.dentistrykey.com/clinical/AValidationFrameworkforBrainTumorSegmentation/3_1s20S1076633207004072.jpg)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Discussion and conclusions

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

- 1
[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

- 2
[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

- 3
[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

- 4
[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

- 5
[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)


[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## References

- 1\. Cates J.E., Whitaker R.T., Jones G.M.: Case study: an evaluation of user-assisted hierarchical watershed segmentation. Med Image Anal 2005; 9: pp. 566-578.


- 2\. Cuadra M.B., Pollo C., Bardera A., et. al.: Atlas-based segmentation of pathological MR brain images using a model of lesion growth. IEEE Trans Med Imaging 2004; 23: pp. 1301-3014.


- 3\. Droske M., Meyer B., Rumpf M., et. al.: An adaptive level set method for interactive segmentation of intracranial tumors. Neurol Res 2005; 27: pp. 363-370.


- 4\. Kaus M.R., Warfield S.K., Nabavi A., et. al.: Automated segmentation of MR images of brain tumors. Radiology 2001; 218: pp. 586-591.


- 5\. Letteboer M.M., Olsen O.F., Dam E.B., et. al.: Segmentation of tumors in magnetic resonance brain images using an interactive multiscale watershed algorithm. Acad Radiol 2004; 11: pp. 1125-1138.


- 6\. Mazzara G.P., Velthuizen R.P., Pearlman J.L., et. al.: Brain tumor target volume determination for radiation treatment planning through automated MRI segmentation. Int J Radiat Oncol Biol Phys 2004; 59: pp. 300-312.


- 7\. Vaidyanathan M., Clarke L.P., Hall L.O., et. al.: Monitoring brain tumor response to therapy using mri segmentation. Magn Res Imaging 1997; 15: pp. 323-334.


- 8\. Xie K., Yang J., Zhang Z.G., et. al.: Semi-automated brain tumor and edema segmentation using MRI. Eur J Radiol 2005; 56: pp. 1.


- 9\. Warfield S.K., Zou K.H., Wells W.M.: Simultaneous truth and performance level estimation (staple): an algorithm for the validation of image segmentation. IEEE Trans Med Imaging 2004; 23: pp. 72.


- 10\. Shi J., Malik J.: Normalized cuts and image segmentation. IEEE Trans Pattern Anal Machine Intell 2000; 22: pp. 888-905.


- 11\. Meila M., Shi J.: Learning segmentation by random walks.2000.pp. 873-879.


- 12\. Archip N., Erard P.J., Egmont-Petersen M., et. al.: A knowledge-based approach for automatic detection of spinal cord in CT images. IEEE Trans Med Imaging 2002; 21: pp. 1504-1516.


- 13\. Archip N., Rohling R., Cooperberg P., et. al.: Ultrasound image segmentation based on spectral clustering techniques. Ultrasound Med Biol 2005; 31: pp. 11.


- 14\. Udupa J.K., Schmidt H., Leblanc V.R., et. al.: A framework for evaluating image segmentation algorithms. Comp Med Imaging Graph 2006; 30: pp. 1.