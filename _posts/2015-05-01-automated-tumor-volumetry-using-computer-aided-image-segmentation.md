---
title: Automated Tumor Volumetry Using Computer-Aided Image Segmentation
author: [Bilwaj Gaonkar MS,Luke Macyszyn MA MD,Michel Bilello MD PhD,Mohammed Salehi Sadaghiani MD,Hamed Akbari MD PhD,Mark A. Attiah MD,Zarina S. Ali MD,Xiao Da MS,Yiqang Zhan PhD,Donald O’ Rourke MD,Sean M. Grady MD,Christos Davatzikos PhD]
date: 2015-05-01 00:00:00 +0700 +07
categories: [{Academic Radiology, Volume 22, Issue 5 SOURCE CL_S_AcademicRadiologyVolume22Issue5 1}]
tags: [Journals,General Radiology]
---
## Rationale and Objectives

Accurate segmentation of brain tumors, and quantification of tumor volume, is important for diagnosis, monitoring, and planning therapeutic intervention. Manual segmentation is not widely used because of time constraints. Previous efforts have mainly produced methods that are tailored to a particular type of tumor or acquisition protocol and have mostly failed to produce a method that functions on different tumor types and is robust to changes in scanning parameters, resolution, and image quality, thereby limiting their clinical value. Herein, we present a semiautomatic method for tumor segmentation that is fast, accurate, and robust to a wide variation in image quality and resolution.

## Materials and Methods

A semiautomatic segmentation method based on the geodesic distance transform was developed and validated by using it to segment 54 brain tumors. Glioblastomas, meningiomas, and brain metastases were segmented. Qualitative validation was based on physician ratings provided by three clinical experts. Quantitative validation was based on comparing semiautomatic and manual segmentations.

## Results

Tumor segmentations obtained using manual and automatic methods were compared quantitatively using the Dice measure of overlap. Subjective evaluation was performed by having human experts rate the computerized segmentations on a 0–5 rating scale where 5 indicated perfect segmentation.

## Conclusions

The proposed method addresses a significant, unmet need in the field of neuro-oncology. Specifically, this method enables clinicians to obtain accurate and reproducible tumor volumes without the need for manual segmentation.

Quantification of tumor volume has become increasingly important for diagnosis, staging, assessment of therapy response, and more recently determination of eligibility for clinical trial enrollment . Currently, assessment of tumor volume is based on two-dimensional (2D) measurements, using standards such as the MacDonald criteria for gliomas, Herscovici criteria for meningiomas, or the RECIST standards for general oncology .

These criteria allow clinicians to obtain a rough estimate of tumor volume by sacrificing accuracy for speed. An accurate measurement of tumor volume, however, requires a complete segmentation of the tumor. This type of segmentation, which can currently be performed manually, requires a tremendous amount of time and hence is not widely used. Thus, automation of tumor segmentation represents an important clinical need that would be invaluable for treating and monitoring patients with brain tumors. Furthermore, such automatic segmentations are likely to be more reproducible and therefore preferable over manual segmentations because of their consistency, which is especially important for longitudinal tumor monitoring.

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Materials and methods

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

![Figure 1, (a) Original T1CE image with meningioma, (b) the geodesic transform generated using a seed placed inside the tumor, (c) and final segmentation generated by thresholding geodesic map.](https://storage.googleapis.com/dl.dentistrykey.com/clinical/AutomatedTumorVolumetryUsingComputerAidedImageSegmentation/0_1s20S1076633215000409.jpg)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

d(x,x')=minP{x,x'}∫u=xu=x'1+γ∇I(u)−−−−−−−−−−√du
d

(

x

,

x

′

)

=

min

P

{

x

,

x

′

}

∫

u

=

x

u

=

x

′

1

+

γ

∇

I

(

u

)

d

u


Where _I_ denotes a gray-scale image defined over a 3D domain Ω and locations in the image domain are indicated by x∈Ω
x

∈

Ω
. _M_ is the initial set of user provided voxels inside the tumor with x'∈M
x

′

∈

M
. Further, P(x,x')
P

(

x

,

x

′

)
denotes the set of all possible paths between _x_ and x'
x

′
, and _u_ parameterizes a specific path in _P_ . _γ_ is a gradient weighting factor which may be used to incorporate prior information if needed. Solving the minimization at every voxel would be computationally intensive to the point of being impractical. Fortunately, there is a computational shortcut described in detail by Toivanen (1996) which makes the computation efficient by visiting each voxel twice.


[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

d(x,x')=minP{x,x'}∫u=xu=x'1+Γ(x)∇I(u)−−−−−−−−−−−−−√du
d

(

x

,

x

′

)

=

min

P

{

x

,

x

′

}

∫

u

=

x

u

=

x

′

1

+

Γ

(

x

)

∇

I

(

u

)

d

u


[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Instructions for Initialization

## Initialization of Automatic Method by Operators

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Instructions Given to Manual Raters and Experts Delineating Tumors in Images

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Subjective Evaluation of the Automated Segmentation Method

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Objective Comparison of Automatic Segmentation to Manual Segmentation Using the Dice Ratio

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

Dice=2V(Sa∩Sm)V(Sa)+V(Sm)
D

i

c

e

=

2

V

(

S

a

∩

S

m

)

V

(

S

a

)

+

V

(

S

m

)


[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Results

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

![Figure 2, Segmentations generated by our technique for (a) glioblastomas, (b) meningiomas, and (c) brain metastasis.](https://storage.googleapis.com/dl.dentistrykey.com/clinical/AutomatedTumorVolumetryUsingComputerAidedImageSegmentation/1_1s20S1076633215000409.jpg)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

Table 1


Expert Rating of Tumor Segmentations


Tumor Average Rating Rater 1 Rater 2 Rater 3 Glioblastoma 4.3 (±0.9) 4.2 (±1.0) 3.7 (±1.2) Meningioma 4.6 (±0.6) 4.5 (±0.7) 4.7 (±0.5) Metastasis 4.4 (±0.8) 4.0 (±1.0) 4.2 (±1.0)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

![Figure 3, Comparison of volumes of tumors computed using the automatic and manual methods. The size of the green circles represent volumes computed using manual segmentations and size of blue circles represent volumes computed using automatic segmentations.](https://storage.googleapis.com/dl.dentistrykey.com/clinical/AutomatedTumorVolumetryUsingComputerAidedImageSegmentation/2_1s20S1076633215000409.jpg)

![Figure 4, Comparison of diameters (in mm) of tumors computed using the automatic and manual methods. The height of the green bars represents diameters computed using manual segmentations and the height of the blue bars represents diameters computed using automatic segmentations.](https://storage.googleapis.com/dl.dentistrykey.com/clinical/AutomatedTumorVolumetryUsingComputerAidedImageSegmentation/3_1s20S1076633215000409.jpg)

![Figure 5, Dice ratios comparing automatic and manual segmentation of glioblastoma multiforme cases.](https://storage.googleapis.com/dl.dentistrykey.com/clinical/AutomatedTumorVolumetryUsingComputerAidedImageSegmentation/4_1s20S1076633215000409.jpg)

![Figure 6, Dice ratios comparing automatic and manual segmentation of meningioma tumor cases.](https://storage.googleapis.com/dl.dentistrykey.com/clinical/AutomatedTumorVolumetryUsingComputerAidedImageSegmentation/5_1s20S1076633215000409.jpg)

![Figure 7, Dice ratios comparing the automatic and manual segmentation of brain metastases cases.](https://storage.googleapis.com/dl.dentistrykey.com/clinical/AutomatedTumorVolumetryUsingComputerAidedImageSegmentation/6_1s20S1076633215000409.jpg)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## Discussion

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

[Get Radiology Tree app to read full this article<](https://clinicalpub.com/app)

## References

- 1\. Kreisl T.N., Kim L., Moore K., et. al.: Phase II trial of single-agent bevacizumab followed by bevacizumab plus irinotecan at tumor progression in recurrent glioblastoma. J ClinOncol 2009; 27: pp. 740-745.


- 2\. Brada M., Hoang-xuan K., Rampling R., et. al.: Multicenter phase II trial of temozolomide in patients with glioblastoma multiforme at first relapse. Ann Oncol 2001; 12: pp. 259-266.


- 3\. Vredenburgh J.J., Desjardins A., Herndon J.E., et. al.: Phase II trial of bevacizumab and irinotecan in recurrent malignant glioma. Clin Cancer Res 2007; 13: pp. 1253-1259.


- 4\. Wen P.Y., Macdonald D.R., Reardon D.A., et. al.: Updated response assessment criteria for high-grade gliomas: response assessment in neuro-oncology working group. J ClinOncol 2010; 28: pp. 1963-1972.


- 5\. Herscovici Z., Rappaport Z., Sulkes J., et. al.: Natural history of conservatively treated meningiomas. Neurology 2004; 63: pp. 1133-1134.


- 6\. Therasse P., Eisenhauer E.A., Verweij J.: RECIST revisited: a review of validation studies on tumour assessment. Eur J Cancer 2006; 42: pp. 1031-1039.


- 7\. Phillips W.E., Velthuizen R.P., Phuphanich S., et. al.: Application of fuzzy c-means segmentation technique for tissue differentiation in MR images of a hemorrhagic glioblastoma multiforme. MagnReson Imaging 1995; 13: pp. 277-290.


- 8\. canClark M.C., Hall L.O., Goldgof D.B., et. al.: Automatic tumor segmentation using knowledge-based techniques. IEEE Trans Med Imaging 1998; 17: pp. 187-201.


- 9\. Lefohn A.E., Cates J.E., Whitaker R.T.: Interactive, GPU based level sets for 3D segmentation in Medical Image Computing and Computer-Assisted Intervention-MICCAI 2003; pp. 564-572.


- 10\. Cobzas D., Birkbeck N., Schmidt M., et. al.: 3D variational brain tumor segmentation using a high dimensional feature set. IEEE 11  th  International Conference in Computer Vision.2007.pp. 1-8.


- 11\. Zhang J., Ma K.K., ErMeng H., et. al.: Tumor segmentation from magnetic resonance imaging by learning via one-class support vector machine. International Workshop on Advanced Image Technology 2004; pp. 207-211.


- 12\. Verma R., Zacharaki E.I., Ou Y., et. al.: Multiparametric tissue characterization of brain neoplasms and their recurrence using pattern classification of MR images. AcadRadiol 2008; 15: pp. 966-977.


- 13\. Ayachi R., Amor N.B.: Brain tumor segmentation using support vector machines. Symbolic and quantitative approaches to reasoning with uncertainty.2009.Springer Lecture Notes in Computer Sciencepp. 736-747.


- 14\. Corso J.J., Sharon E., Dube S., et. al.: Efficient multilevel brain tumor segmentation with integrated Bayesian model classification. IEEE Trans Med Imaging 2008; 27: pp. 629-640.


- 15\. Menze B.H., Van leemput K., Lashkari D., et. al.: A generative model for brain tumor segmentation in multi-modal images. Med Image ComputComput Assist Interv 2010; 13: pp. 151-159.


- 16\. Gering D.T., Grimson W.E.L., Kikinis R.: Recognizing deviations from normalcy for brain tumor segmentation. Medical Image Computing and Computer-Assisted Intervention - MICCAI 2002; 2488: pp. 388-395.


- 17\. Prastawa M., Bullitt E., Ho S., et. al.: A brain tumor segmentation framework based on outlier detection. Med Image Anal 2004; 8: pp. 275-283.


- 18\. Kaus M.R., Warfield S.K., Nabavi A., et. al.: Automated segmentation of MR images of brain tumors. Radiology 2001; 218: pp. 586-591.


- 19\. Gaonkar B., Erus G., Bryan N., et. al.: Automated segmentation of brain lesions by combining intensity and spatial Information. IEEE International Symposium on Biomedical Imaging 2010; pp. 93-96.


- 20\. Gaonkar B., Erus G., Pohl K.M., et. al.: Automated segmentation of cortical necrosis using a wavelet based abnormality detection system. Proc IEEE IntSymp Biomed Imaging 2011; pp. 1391-1395.


- 21\. Gooya A., Pohl K.M., Bilello M., et. al.: GLISTR: glioma image segmentation and registration. IEEE Trans Med Imaging 2012; 31: pp. 1941-1954.


- 22\. Gaonkar B., Shu L., Hermosillo G., et. al.: Adaptive geodesic transform for segmentation of vertebrae on CT images. SPIE Medical Imaging 2014; 903516–903516


- 23\. Antonio C., Toby S., Andrew B.: Geos: Geodesic Image Segmentation, European Conference in Computer Vision 2008; pp. 99-112.


- 24\. Toivanen P.J.: New geodesic distance transforms for gray-scale images Pattern Recognition Letters 1996; 17: pp. 437-450.


- 25\. Dice L.R.: Measures of the amount of ecologic association between species. Ecology 1945; 26: pp. 297-302.


- 26\. Hashiba T., Hashimoto N., Izumoto S., et. al.: Serial volumetric assessment of the natural history and growth pattern of incidentally discovered meningiomas. J Neurosurg 2009; 110: pp. 675-684.


- 27\. Hopper K.D., Kasales C.J., Eggli K.D., et. al.: The impact of 2D versus 3D quantitation of tumor bulk determination on current methods of assessing response to treatment. J Comput Assist Tomogr 1996; 20: pp. 930-937.


- 28\. Pohl K.M., Konukoglu E., Novellas S., et. al.: A new metric for detecting change in slowly evolving brain tumors: validation in meningioma patients. Neurosurgery 2011; 68: pp. 225-233.


- 29\. Sorensen A.G., Patel S., Harmath C., et. al.: Comparison of diameter and perimeter methods for tumor volume calculation. J Clin Oncol 2001; 19: pp. 551-557.


- 30\. Warren K.E., Patronas N., Aikin A.A., et. al.: Comparison of one-, two-, and three-dimensional measurements of childhood brain tumors. J Natl Cancer Inst 2001; 93: pp. 1401-1405.


- 31\. Ahrar K., Ahrar J.U., Javadi S., et. al.: Real-time magnetic resonance imaging-guided cryoablation of small renal tumors at 1.5 T. Invest Radiol 2013; 48: pp. 437-444.